\documentclass[11pt]{article}
\usepackage{listings}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{makecell}
\newcommand{\numpy}{{\tt numpy}}    % tt font for numpy

\topmargin -.5in
\textheight 9in
\oddsidemargin -.25in
\evensidemargin -.25in
\textwidth 7in

\begin{document}

% ========== Edit your name here
\author{Francesco Penasa}
\title{Final Report \\Inventory-managment \\Security Testing \\2019/2020}
\maketitle

\medskip

\section{Introduction}
This is the report for the final project of the course Security Testing, 2019/2020. The project consisted to analyse the PHP code of a simple website running in local, find its XSS vulnerabilities and  fix them. In the following sections we will show the procedures done and the results obtained.


\section{Taint Analysis}
In order to discover the XSS vulnerabilities present in the code, the tool "Pixy" has been used. Pixy execute a Taint Analisys on the file given in input. A total of 76 possible XSS vulnerabilities have been discovered, all of them have been analysed in depth to understand their classification as false positive or true positive.


%\begin{table}[h!]
 % \begin{center}
 \begin{longtable}[H]{| p{.30\textwidth} | p{.50\textwidth} | p{.15\textwidth} |}

\caption{Graphs produced by the Pixy execution.}
\label{tab:table1}
	

\cr
\hline
\textbf{Pixy file} & \textbf{Description} & \textbf{Evaluation} \\
      
      	\hline
      	xss\_changeBio.php\_1\_min	
      	& \makecell{ \texttt{changeBio.php line 22} \\
				 displayed in an input tag that  \\
				 does not interpret the html code.}  
	 	& False Positive \\

	 	\hline
	  	xss\_changePassword.php\_1\_min 	
	  	& \makecell{ \texttt{changePassword.php line 43} \\
 				 displayed in an input tag that  \\
				 does not interpret the html code.}
	 	& False Positive \\

	 	\hline
	  	xss\_changeUsername.php\_1\_min 	
	  	& \makecell{ \texttt{changeUsername.php line 23} \\
				 displayed in an input tag that  \\
				 does not interpret the html code.}  
	 	& False Positive \\

	 	\hline
	  	xss\_createBrand.php\_1\_min 	
	  	& \makecell{ \texttt{createBrand.php line 25} \\
				 displayed in an input tag that  \\
				 does not interpret the html code.}
	 	& False Positive \\

	 	\hline
	  	xss\_createCategories.php\_1\_min	  	
	  	& \makecell{ \texttt{createCategories.php line 25} \\
				 displayed in an input tag that  \\
				 does not interpret the html code.}
	 	& False Positive \\

	 	\hline
	  	xss\_createOrder.php\_1\_min 	
	  	& \makecell{ \texttt{createOrder.php line 70} \\
				 displayed in an input tag that  \\
				 does not interpret the html code.}
	 	& False Positive \\

	 	\hline
	  	xss\_createProduct.php\_1\_min 	
	  	& \makecell{ \texttt{createProduct.php line 43} \\
				 displayed in an input tag that  \\
				 does not interpret the html code.}
	 	& False Positive \\

	 	\hline
	  	xss\_createUser.php\_1\_min 	
	  	& \makecell{ \texttt{createUser.php line 30} \\
				 displayed in an input tag that  \\
				 does not interpret the html code.}
	 	& False Positive \\

% ---------------- first dashboard.php ------------------- %

	 	\hline
	  	xss\_dashboard.php\_3\_min 	
	  	& \makecell{ \texttt{dashboard.php line 75} \\
				 the variable echoed can contain only \\
				 a number, since it is create counting \\
				 the rows of the a query.}  
	 	& False Positive \\

	 	\hline
	  	xss\_dashboard.php\_4\_min 	
	  	& \makecell{ \texttt{dashboard.php line 87} \\
				 the variable echoed can contain only \\
				 a number, since it is create counting \\
				 the rows of the a query.}    
	 	& False Positive \\

	 	\hline
	  	xss\_dashboard.php\_5\_min 	
	  	& \makecell{ \texttt{dashboard.php line 101} \\
				 the variable echoed can contain only \\
				 a number, since it is create counting \\
				 the rows of the a query.}    
	 	& False Positive \\

	 	\hline
	  	xss\_dashboard.php\_10\_min 	
	  	& \makecell{ \texttt{dashboard.php line 153} \\
				 display the username of the logged user\\ 
				 without any sanitization.}  
	 	& \textbf{True Positive} \\

	 	\hline
	  	xss\_dashboard.php\_11\_min 	
	  	& \makecell{ \texttt{dashboard.php line 154} \\
				 the variable echoed can contain only \\
				 a number, since it is create counting \\
				 the rows of the a query.}    
	 	& False Positive \\

	 	\hline
	  	xss\_editBrand.php\_1\_min 	
	  	& \makecell{ \texttt{editBrand.php line 25} \\
				 the content of the echoed variable \\
				 \texttt{\$valid} is fixed. Only a specific message\\
				  written by the developer can be displayed.}  
	 	& False Positive \\

	 	\hline
	  	xss\_editCategories.php\_1\_min 	
	  	& \makecell{ \texttt{editCategories.php line 25} \\
				 same as the previous cell.}  
	 	& False Positive \\

	 	\hline
	  	xss\_editOrder.php\_1\_min 	
	  	& \makecell{ \texttt{editOrder.php line 87} \\
				 the content of the echoed variable \\
				 \texttt{\$valid} is fixed. Only a specific message\\
				  written by the developer can be displayed.}  
	 	& False Positive \\

	 	\hline
	  	xss\_editPayment.php\_1\_min.dot 	
	  	& \makecell{ \texttt{editPayment.php line 31} \\
				 the content of the echoed variable \\
				 \texttt{\$valid} is fixed. Only a specific message\\
				  written by the developer can be displayed.}  
	 	& False Positive \\

	 	\hline
	  	xss\_editProduct.php\_1\_min.dot 	
	  	& \makecell{ \texttt{editProduct.php line 31} \\
				 the content of the echoed variable \\
				 \texttt{\$valid} is fixed. Only a specific message\\
				  written by the developer can be displayed.}  
	 	& False Positive \\
	 	
	 	\hline
	  	xss\_editProductImage.php\_1\_min 	
	  	& \makecell{ \texttt{editProductImage.php line 35} \\
				 the content of the echoed variable \\
				 \texttt{\$valid} is fixed. Only a specific message\\
				  written by the developer can be displayed.}  
	 	& False Positive \\
	 	
	 	\hline
	  	xss\_editUser.php\_1\_min.dot 	
	  	& \makecell{ \texttt{editUser.php line 27} \\
				 the content of the echoed variable \\
				 \texttt{\$valid} is fixed. Only a specific message\\
				  written by the developer can be displayed.}  
	 	& False Positive \\

% ===============================================================================
% ------------- STARTING FETCH -------------------------------------
% ===============================================================================


	 	\hline
	  	xss\_fetchBrand.php\_1\_min 	
	  	& \makecell{ \texttt{fetchBrand.php line 48} \\
				 Display the brand name without any sanitization.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_fetchCategories.php\_1\_min 	
	  	& \makecell{ \texttt{fetchCategories.php line 48} \\
					Display the category name without any sanitization.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_fetchOrder.php\_1\_min	
	  	& \makecell{ \texttt{fetchOrder.php line 71} \\
				Display the client name and the client contact \\
				without any sanitization.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_fetchOrderData.php\_1\_min 	
	  	& \makecell{ \texttt{fetchOrderData.php line 19} \\
				 As it is at the moment it is not a vulnerability,\\ 
				 but it could become one if some other element
				 of \\ the query are used in the order page.}  
	 	& False Positive \\

	 	\hline
	  	xss\_fetchProduct.php\_1\_min 	
	  	& \makecell{ \texttt{fetchProduct.php line 83} \\
				 Display the product name, the brand name and \\
				 the category name without any sanitization.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_fetchProductData.php\_1\_min 	
	  	& \makecell{ \texttt{fetchProductData.php line 12} \\
					Display the product name \\
				  without any proper sanitization.}    
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_fetchProductImage.php\_1\_min 	
	  	& \makecell{ \texttt{fetchProductImage.php line 13} \\
				 displayed in an input tag that \\
					does not interpret the html code}  
	 	& False Positive \\

	 	\hline
	  	xss\_fetchSelectedBrand.php\_1\_min 	
	  	& \makecell{ \texttt{fetchSelectedBrand.php line 16} \\
				 displayed in an input tag that \\
					does not interpret the html code} 
	 	& False Positive \\

	 	\hline
	  	xss\_fetchSelectedCategories.php\_1\_min 	
	  	& \makecell{ \texttt{fetchSelectedCategories.php line 16} \\
				 displayed in an input tag that \\
					does not interpret the html code}
	 	& False Positive \\

	 	\hline
	  	xss\_fetchSelectedProduct.php\_1\_min 	
	  	& \makecell{ \texttt{fetchSelectedProduct.php line 16} \\
				 displayed in an input tag that \\
					does not interpret the html code}
	 	& False Positive \\

	 	\hline
	  	xss\_fetchSelectedUser.php\_1\_min 	
	  	& \makecell{ \texttt{fetchSelectedUser.php line 16} \\
				 displayed in an input tag that \\
					does not interpret the html code}
	 	& False Positive \\

	 	\hline
	  	xss\_fetchUser.php\_1\_min
	  	& \makecell{ \texttt{fetchUser.php line 47} \\
				 Display the username without any sanitization.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_getOrderReport.php\_1\_min 	
	  	& \makecell{ \texttt{getOrderReport.php line 49} \\
				 Display the client name and client contact \\
				 without any proper sanitization.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_index.php\_2\_min
	  	& \makecell{ \texttt{index.php line 100} \\
				 \texttt{\$PHP\_SELF} is a variable that returns \\
				 the current script being executed.}  
	 	& False Positive \\


%==========================================================================
% orders
%==========================================================================
	 	\hline
	  	xss\_orders.php\_6\_min. 	
	  	& \makecell{ \texttt{orders.php line 37} \\
				 The variable echoed contains the ID which \\
				 cannot be modified by the attacker.}  
	 	& False Positive \\

	 	\hline
	  	xss\_orders.php\_11\_min 	
	  	& \makecell{ \texttt{orders.php line 111} \\
				 Display the product name without any sanitization.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_orders.php\_20\_min 	
	  	& \makecell{ \texttt{orders.php line 287} \\
				 The date comes from a field of the DB that \\
				 can contain only objects of date type.}  
	 	& False Positive \\

	 	\hline
	  	xss\_orders.php\_21\_min 	
	  	& \makecell{ \texttt{orders.php line 293} \\
				 displayed in an input tag that \\
				 does not interpret the html code.}  
	 	& False Positive \\

	 	\hline
	  	xss\_orders.php\_22\_min 	
	  	& \makecell{ \texttt{orders.php line 299} \\
				 displayed in an input tag that \\
				 does not interpret the html code.}  
	 	& False Positive \\

	 	\hline
	  	xss\_orders.php\_27\_min 	
	  	& \makecell{ \texttt{orders.php line 345} \\
				 Display the product name without any sanitization.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_orders.php\_29\_min 	
	  	& \makecell{ \texttt{orders.php line 353} \\
				 In order to be used in the web page\\
				 rate has to be a number.}  
	 	& False Positive \\

	 	\hline
	  	xss\_orders.php\_31\_min 	
	  	& \makecell{ \texttt{orders.php line 354} \\
				 In order to be used in the web page\\
				 rate has to be a number.}  
	 	& False Positive \\

	 	\hline
	  	xss\_orders.php\_32\_min 	
	  	& \makecell{ \texttt{orders.php line 365} \\
				 In order to be used in the web page\\
				 quantity has to be a number.}  
	 	& False Positive \\

	 	\hline
	  	xss\_orders.php\_35\_min 	
	  	& \makecell{ \texttt{orders.php line 380} \\
				 In order to be used in the web page\\
				 quantity has to be a number.}  
	 	& False Positive \\


	 	\hline
	  	xss\_orders.php\_37\_min 	
	  	& \makecell{ \texttt{orders.php line 384} \\
				 The variable echoed is calculated \\
				 through not vulnerable parameters.}  
	 	& False Positive \\


	 	\hline
	  	xss\_orders.php\_39\_min 	
	  	& \makecell{ \texttt{orders.php line 385} \\
				The variable echoed is calculated \\
				through not vulnerable parameters.}  
	 	& False Positive \\


	 	\hline
	  	xss\_orders.php\_41\_min 	
	  	& \makecell{ \texttt{orders.php line 404} \\
				 The variable echoed is calculated \\
				through not vulnerable parameters.}  
	 	& False Positive \\


	 	\hline
	  	xss\_orders.php\_42\_min 	
	  	& \makecell{ \texttt{orders.php line 405} \\
				The variable echoed is calculated \\
				through not vulnerable parameters.}
	 	& False Positive \\


	 	\hline
	  	xss\_orders.php\_43\_min 	
	  	& \makecell{ \texttt{orders.php line 412} \\
				 The variable echoed is calculated \\
				through not vulnerable parameters.}
	 	& False Positive \\


	 	\hline
	  	xss\_orders.php\_44\_min 	
	  	& \makecell{ \texttt{orders.php line 413} \\
				The variable echoed is calculated \\
				through not vulnerable parameters.} 
	 	& False Positive \\


	 	\hline
	  	xss\_orders.php\_45\_min 	
	  	& \makecell{ \texttt{orders.php line 419} \\
				 In order to be used in the web page\\
				 the variable echoed has to be a number.}  
	 	& False Positive \\


	 	\hline
	  	xss\_orders.php\_46\_min 	
	  	& \makecell{ \texttt{orders.php line 425} \\
				 The variable echoed is calculated \\
				through not vulnerable parameters.}  
	 	& False Positive \\


	 	\hline
	  	xss\_orders.php\_47\_min	
	  	& \makecell{ \texttt{orders.php line 426} \\
				 The hidden variable echoed is calculated \\
				through not vulnerable parameters.}  
	 	& False Positive \\


	 	\hline
	  	xss\_orders.php\_50\_min.dot 	
	  	& \makecell{ \texttt{orders.php line 432} \\
				The variable echoed is calculated \\
				through not vulnerable parameters.}    
	 	& False Positive \\


	 	\hline
	  	xss\_orders.php\_51\_min.dot 	
	  	& \makecell{ \texttt{orders.php line 433} \\
				The hidden variable echoed is calculated \\
				through not vulnerable parameters.}    
	 	& False Positive \\

	 	\hline
	  	xss\_orders.php\_52\_min.dot 	
	  	& \makecell{ \texttt{orders.php line 439} \\
				The variable echoed is calculated \\
				through not vulnerable parameters.}    
	 	& False Positive \\

	 	\hline
	  	xss\_orders.php\_53\_min.dot 	
	  	& \makecell{ \texttt{orders.php line 448} \\
				In order to be used in the web page\\
				 the variable echoed has to be a number.}      
	 	& False Positive \\

	 	\hline
	  	xss\_orders.php\_54\_min.dot 	
	  	& \makecell{ \texttt{orders.php line 454} \\
				The variable echoed is calculated \\
				through not vulnerable parameters.}    
	 	& False Positive \\

	 	\hline
	  	xss\_orders.php\_55\_min.dot 	
	  	& \makecell{ \texttt{orders.php line 455} \\
				The hidden variable echoed is calculated \\
				through not vulnerable parameters.}    
	 	& False Positive \\

	 	\hline
	  	xss\_orders.php\_64\_min.dot 	
	  	& \makecell{ \texttt{orders.php line 513} \\
				The variable echoed \$\_GET[i] is the \\
				ID and cannot be modified by the attacker.}    
	 	& False Positive \\

	 	\hline
	  	xss\_printOrder.php\_1\_min 	
	  	& \makecell{ \texttt{printOrder.php line 193} \\
				Display the client name, client contact and \\ product name
				 without any proper sanitization.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_product.php\_1\_min 	
	  	& \makecell{ \texttt{product.php line 109} \\
				Display the brand name \$row['1'] \\
				 without any proper sanitization.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_product.php\_2\_min 	
	  	& \makecell{ \texttt{product.php line 128} \\
				Display the category name \\
				 without any proper sanitization.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_product.php\_3\_min 	
	  	& \makecell{ \texttt{product.php line 267} \\
				Display the brand name \\
				 without any proper sanitization.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_product.php\_4\_min 	
	  	& \makecell{ \texttt{product.php line 286} \\
				Display the category name \\
				 without any proper sanitization.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_removeBrand.php\_1\_min 	
	  	& \makecell{ \texttt{removeBrand.php line 24} \\
				The variable echoed contains an ID which \\
			 	cannot be modified by the attacker.}
	 	& False Positive\\

	 	\hline
	  	xss\_removeCategories.php\_1\_min 	
	  	& \makecell{ \texttt{removeCategories.php line 24} \\
				The variable echoed contains an ID which \\
			 	cannot be modified by the attacker.}
	 	& False Positive\\
	 	
	 	\hline
	  	xss\_removeOrder.php\_1\_min 	
	  	& \makecell{ \texttt{removeOrder.php line 26} \\
				The variable echoed contains an ID which \\
			 	cannot be modified by the attacker.}
	 	& False Positive\\

	 	\hline
	  	xss\_removeProduct.php\_1\_min 	
	  	& \makecell{ \texttt{removeProduct.php line 24} \\
				The variable echoed contains an ID which \\
			 	cannot be modified by the attacker.}
	 	& False Positive\\

	 	\hline
	  	xss\_removeUser.php\_1\_min 	
	  	& \makecell{ \texttt{removeUser.php line 24} \\
					The variable echoed contains an ID which \\
			 	cannot be modified by the attacker.} 
	 	& False Positive\\


	 	\hline
	  	xss\_setting.php\_1\_min 	
	  	& \makecell{ \texttt{setting.php line 35} \\
				With some proper combination of characters \\ 
				it is possible to use the "change username" field \\ 
				 for a XSS attack.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_setting.php\_2\_min 	
	  	& \makecell{ \texttt{setting.php line 41} \\
				The variable echoed contains an ID which \\
			 	cannot be modified by the attacker.}
	 	& False Positive\\

	 	\hline
	  	xss\_setting.php\_3\_min 	
	  	& \makecell{ \texttt{setting.php line 57} \\
				With some proper combination of characters \\ 
				it is possible to use the "change bio" field \\
				for a XSS attack.}  
	 	& \textbf{True Positive}\\

	 	\hline
	  	xss\_setting.php\_4\_min 	
	  	& \makecell{ \texttt{setting.php line 63} \\
				The variable echoed contains an ID which \\
			 	cannot be modified by the attacker.}  
	 	& False Positive\\

	 	\hline
	  	xss\_setting.php\_5\_min 	
	  	& \makecell{ \texttt{setting.php line 99} \\
				The variable echoed contains an ID which \\
			 	cannot be modified by the attacker.}
	 	& False Positive\\

	 	\hline
	  	xss\_ssp.php\_1\_min 	
	  	& \makecell{ \texttt{ssp.php line 55} \\
				Server side process script.}  
	 	& False Positive\\

	 	\hline


	 	    
\end{longtable}


\section{Security Testing}
For each vulnerability evaluated as True Positive a test case has been written and a fix has been provided. 
To realize the test cases has been used the IDE Eclipe and the Selenium framework. 
In order to make the test cases cleaner are easibly readable we have used the Page Object method to organize the testing environment.
All the vulnerabilities founded during the analysis are covered with a java file with the same name and every page of the website has its own file.
There are two vulnerabilities that couldn't be tested properly: the first, \texttt{xss\_printOrder.php\_1\_min} which have its own test file that requires some specific libraries to execute properly. While the second, \texttt{xss\_getOrderReport.php\_1\_min} could not be tested since \texttt{report.php} does not work properly.

\section{Fixes}
In this section are displayed the fixes added to the code, to remove the XSS vulnerabilities.
The last fix showed is one extra fix that has been added to the table in order to fix a XSS vulnerability that was not signaled by Pixy. 

\begin{enumerate}
	\item \textbf{dashboard.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{153 echo (\$orderResult['username]']);} \\
	\textbf{Fixed:} \\
	 	\texttt{153 echo (htmlentities(\$orderResult['username]']));} 
	
	\item \textbf{fetchBrand.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{48 \$output['data'][] = array(\$row[1]), \$activeBrands, \$button);} \\
	\textbf{Fixed:} \\
		\texttt{48 \$output['data'][] = array(htmlentities(\$row[1])), \$activeBrands, \$button);} \\
	
	\item \textbf{fetchCategories.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{48 \$output['data'][] = array(\$row[1]), \$activeBrands, \$button);} \\
	\textbf{Fixed:} \\
		\texttt{48 \$output['data'][] = array(htmlentities(\$row[1])), \$activeBrands, \$button);} \\

	\item \textbf{fetchOrder.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{50 \$output['data'][] = array(\$x, \$row[1]), \$row[2], \$row[3], \$itemCountRow, \$paymentStatus, \$button);} \\
	\textbf{Fixed:} \\
		\texttt{50 \$output['data'][] = array(\$x, \$row[1]), htmlentities(\$row[2]), htmlentities(\$row[3]), \$itemCountRow, \$paymentStatus, \$button);} \\


	\item \textbf{fetchProduct.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{59 \$output['data'][] = array(\$productImage, \$row[1], \$row[6], \$row[5],
		\$brand, \$category, \$active,\$button);} \\
	\textbf{Fixed:} \\
		\texttt{59 \$output['data'][] = array(\$productImage, htmlentities(\$row[1]), htmlentities(\$row[6]), \$row[5], htmlentities(\$brand), htmlentities(\$category), \$active,\$button);} \\



\newpage
	\item \textbf{fetchProductData.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{13 echo json\_encode(\$data);} \\
	\textbf{Fixed:} \\
		\texttt{13 \$data[0][1] = htmlentities(\$data[0][1]);} \\
		\texttt{14 echo json\_encode(\$data);} \\

	\item \textbf{fetchUser.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{35 \$output['data'][] = array(\$username, \$button);} \\
	\textbf{Fixed:} \\
		\texttt{35 \$output['data'][] = array(htmlentities(\$username), \$button);} \\

	\item \textbf{getOrderReport.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{31 \$table .= '<tr>
        <td><center>'.\$result['order\_date'].'</center></td>} \\
        \texttt{<td><center>'.\$result['client\_name'].'</center></td>} \\
        \texttt{<td><center>'.\$result['client\_contact'].'</center></td>} \\
        \texttt{<td><center>'.\$result['grand\_total'].'</center></td>
      </tr>';}\\
	\textbf{Fixed:} \\
		\texttt{31 \$table .= '<tr>
        <td><center>'.\$result['order\_date'].'</center></td>} \\
        \texttt{<td><center>'.htmlentities(\$result['client\_name']).'</center></td>} \\
        \texttt{<td><center>'.htmlentities(\$result['client\_contact']).'</center></td>} \\
        \texttt{<td><center>'.\$result['grand\_total'].'</center></td>
      </tr>';}\\


	\item \textbf{orders.php} \\
	\textbf{Vulnerable:}\\
	 	\texttt{111 echo "<option value='".\$row['product\_id']."'}\\
	 	\texttt{ id='changeProduct".\$row['product\_id']."'>".(\$row['product\_name'])."</option>";} \\
	\textbf{Fixed:} \\
	 	\texttt{111 echo "<option value='".\$row['product\_id']."'}\\
	 	\texttt{ id='changeProduct".\$row['product\_id']."'>".htmlentities(\$row['product\_name'])."</option>";} 

	\item \textbf{orders.php} \\
	\textbf{Vulnerable:}\\
	 	\texttt{345 echo "<option value='".\$row['product\_id']."' } \\
	 	\texttt{id='changeProduct".\$row['product\_id']."' ".\$selected." >"} \\
	 	\texttt{.(\$row['product\_name'])."</option>";} \\
	\textbf{Fixed:} \\
	 	\texttt{345 echo "<option value='".\$row['product\_id']."' } \\
	 	\texttt{id='changeProduct".\$row['product\_id']."' ".\$selected." >"} \\
	 	\texttt{.htmlentities(\$row['product\_name'])."</option>";} 
	
	\item \textbf{printOrder.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{13 \$clinetName = \$orderData[1];} \\
		\texttt{14 \$clinetContact = \$orderData[2];} \\
		\texttt{136 <td style="border-left: 1px solid black;height: 27px;">'.\$row[4].'</td>} \\
	\textbf{Fixed:} \\ 
		\texttt{13 \$clinetName = htmlentities(\$orderData[1]);} \\
		\texttt{14 \$clinetContact = htmlentities(\$orderData[2]);} \\
		\texttt{136 <td style="border-left: 1px solid black;height: 27px;">'.htmlentities(\$row[4]).'</td>} \\

	\item \textbf{product.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{109 echo "<option value='".\$row[0]."'>". \$row[1]."</option>";} \\
	\textbf{Fixed:} \\
		\texttt{109 echo "<option value='".\$row[0]."'>". htmlentities(\$row[1])."</option>";} \\

	\item \textbf{product.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{128 echo "<option value='".\$row[0]."'>".\$row[1]."</option>";} \\
	\textbf{Fixed:} \\
		\texttt{128 echo "<option value='".\$row[0]."'>".htmlentities(\$row[1])."</option>";} \\

	\item \textbf{product.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{267 echo "<option value='".\$row[0]."'>".\$row[1]."</option>";}\\
	\textbf{Fixed:} \\
		\texttt{267 echo "<option value='".\$row[0]."'>".htmlentities(\$row[1])."</option>";} \\

	\item \textbf{product.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{286 echo "<option value='".\$row[0]."'>".\$row[1]."</option>";} \\
	\textbf{Fixed:} \\
		\texttt{286 echo "<option value='".\$row[0]."'>".htmlentities(\$row[1])."</option>";} \\
	
	\item \textbf{setting.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{35 <input type="text" class="form-control" id="username" name="username"}\\ 
		\texttt{placeholder="Usename" value="<?php echo (\$result['username']); ?>"/>} \\
		
	\textbf{Fixed:} \\
		\texttt{35 <input type="text" class="form-control" id="username" name="username"}\\ 
		\texttt{placeholder="Usename" value="<?php echo (htmlentities(\$result['username'])); ?>"/>} \\

	\newpage
	\item \textbf{setting.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{57 <input type="text" class="form-control" id="bio" name="bio" placeholder="Bio"} 
		\texttt{value="<?php echo (\$result['bio']); ?>"/>} \\
		
	\textbf{Fixed:} \\
		\texttt{57 <input type="text" class="form-control" id="bio" name="bio" placeholder="Bio"} 
		\texttt{value="<?php echo (htmlentities(\$result['bio'])); ?>"/>} \\
		
	% last one
	\item \textbf{dashboard.php} \\
	\textbf{Vulnerable:} \\ 
		\texttt{50 echo (\$\_SESSION['username']);} \\
		\texttt{57 echo (\$\_SESSION['username']);} \\
	\textbf{Fixed:} \\
	 	\texttt{50 echo (htmlentities(\$\_SESSION['username']));} \\
	 	\texttt{57 echo (htmlentities(\$\_SESSION['username']));} \\

\end{enumerate}

\section{Conclusion}

On the 76 possible vulnerabilities we have found 17 True Positive and one vulnerability that was not signaled by Pixy. The test cases done and their fixes cover only xss vulnerabilities, for all the others type of vulnerabilities a deeper analysis has to be done.


\end{document}
\grid
\grid